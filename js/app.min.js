function search(t){location.hash="#"+t,t.length>=2?$.ajax({type:"post",url:"/api/search",data:{q:t},beforeSend:function(){$("#result").css("opacity","0.5")},success:function(t){0!=t.count&&(rednerMainTemplate(t),$("#result").css("opacity","1")),0==t.count&&(rednerNotFoundTemplate(),$(".error_show").text("Ничего не найдено"),$("#result").css("opacity","1"))}}):(rednerNotFoundTemplate(),$(".error_show").text("Введите не менее двух символов"),$("#result").css("opacity","1"))}function rednerMainTemplate(t){var s=$("#MainTemplate").html();Mustache.parse(s);var c=Mustache.render(s,t);$("#result").html(c),$("#result").css("display","")}function rednerNotFoundTemplate(){var t=$("#NotFoundTemplate").html();Mustache.parse(t);var s=Mustache.render(t);$("#result").html(s),$("#result").css("display","")}function get_config(){$.ajax({type:"get",url:"/api/get_config",success:function(t){$("#count_contacts").text(t.count),$("title").text(t.title)}})}$(document).ready(function(){get_config(),$.get("../template/templates.html",function(t){$(".templates").html(t)}),window.location.hash&&($(".search_text").val(window.location.hash.slice(1)),search(window.location.hash.slice(1)))}),$("form").submit(function(){return!1}),$(function(){$(".search_text").keydown(function(t){13===t.keyCode&&search($(".search_text").val())}),$(".search_button").click(function(){search($(".search_text").val())}),$(".search_text").bind("input",function(){search($(".search_text").val())})}),$(function(t){t("#phone").mask("+38(999)99-99-999")}),$("form").on("submit",function(t){t.preventDefault();var s=$(this).serialize();$.ajax({type:"POST",url:"../api/add",data:s,dataType:"json",beforeSend:function(){$("#add_contact").css("opacity","0.5")},success:function(t){0==t.status&&($("#Send_Form").notify("Внутренняя ошибка","error"),$("#url_vk").notify("Проверьте правильность ссылки","warn")),1==t.status&&$("#phone").notify("Номер уже есть в базе","warn"),2==t.status&&$("#phone").notify("Успешно добавлен","success"),$("#add_contact").css("opacity","1")},error:function(t){$("#add_contact").css("opacity","1")}})}),$(function(){$("#add_contact_button").click(function(){$("#add_contact").css("display",""),$("#custom-search-input").css("display","none"),$("#result").css("display","none"),$("#contact-list").css("display","none"),$("#export_contact").css("display","none")})}),$(function(){$(".close_form").click(function(){$("#add_contact").css("display","none"),$("#custom-search-input").css("display",""),$("#result").css("display",""),$("#contact-list").css("display","")})}),$(function(){$("#export_button").click(function(){$("#export_contact").css("display",""),$("#add_contact").css("display","none"),$("#custom-search-input").css("display","none"),$("#result").css("display","none"),$("#contact-list").css("display","none")})}),$(function(){$(".close_export").click(function(){$("#export_contact").css("display","none"),$("#custom-search-input").css("display",""),$("#result").css("display",""),$("#contact-list").css("display","")})});